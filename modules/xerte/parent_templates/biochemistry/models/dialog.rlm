	<PG name="dialog">		<SCR isFunc="1" name="sortAnswerTxt"><![CDATA[// _______________ FUNCTION ___________________// SETS ANSWER TO INCLUDE VALUES FOR ANY VARIABLES// variable names in answer should be marked up with { }ansTxt = textToCheck;tempTxt = '';tempNo = 0;// replaces variable names in answer with valuefor (j=0;j<variables.length;j++){  varNo = 0;  counter = 0;  while (varNo < ansTxt.length){    // searches ansTxt for each variable    varPos = ansTxt.indexOf(markUpStart+variables[j]+markUpEnd,varNo);        if (varPos == -1) // none or no more found    {      tempTxt += ansTxt.substring(tempNo,ansTxt.length);      varNo = ansTxt.length;      // will leave while loop now    } else { // variable found      varName = variables[j];      varValue = expression(varName, this);      tempTxt += ansTxt.substring(tempNo,varPos) + varValue;      varNo = varPos+variables[j].length;      tempNo = varNo+2;    }  }    ansTxt = tempTxt;  tempTxt = "";  tempNo = 0;}textToCheck = ansTxt;//debug(textToCheck);]]></SCR>		<SCR name="getPageID"><![CDATA[// SET UP PAGE & GET INFO NEEDED FROM XML// recalculate variable valuesvaluesCalc = 0;getAlgebraInfo();pageIcon = icon.parentNode.clip();myXML = new XML(extXML.firstChild.childNodes[rootIcon.getPageIndex() - pgOffset]);pageIcon.templateData = myXML.toObject();myInfo = pageIcon.templateData.dialog[0];rootIcon.setTitleText(XMLdata.name);STYLES.inputSize = STYLES.defaultSize;initY = 40;if (myInfo.narration != undefined){  narration = myInfo.narration;  rootIcon.broadcast('showAudio');}ansNo = myInfo.dialogStep.length; // no. of questions / answersansArray = new Array();for (i=0;i<ansNo;i++){  ansArray.push(myInfo.dialogStep[i].answer);  textToCheck = ansArray[i];    sortAnswerTxt(); // calls function to replace any vars in answer with values   ansArray.splice(i,1,textToCheck);}]]></SCR>		<DIS h="474" w="540" tabIndex="-1" id="panel" name="panel" x="240" y="20" type="ext" url="templatePath + 'common/whitePanel.swf'"><![CDATA[]]></DIS>		<DIS id="dialogText" embedVars="1" h="475" scrolling="auto" name="text" x="20" y="20" w="200" type="text"><![CDATA[{myInfo.text}]]></DIS>		<SCR name="makeQuestions"><![CDATA[if (icon.attributes.built != "true"){  icon.nextSibling.firstChild.duplicate(myInfo.dialogStep.length - 1);  icon.attributes.built = "true";}]]></SCR>		<DEC id="dlg" name="questions" repeat="all" branch="sequence" pause="1" erase="0" eraseOnExit="0">			<PG name="protoQuestion">				<DIS embedVars="1" textColour="#333333" id="qt" name="questionText" x="panel._x + 20" y="initY" w="300" h="10" type="text"><![CDATA[{myInfo.dialogStep[icon.parentNode.index()].question}]]></DIS>				<INT id="curInt" name="interaction" perpetual="1">					<RES rs="te" name="textEntry" type="textEntry" x="560" y="initY + qt._height - 18" w="200" h="100" phrase="*" scrolling="0" border="1" erase="1" exit="0">						<SCR name="checkAnswer"><![CDATA[ans = te.text.toLowerCase();answers = ansArray[dlg.getPageIndex()].toLowerCase().split(',');fb="";feedback.setText("");attempts++;initY = te._y + te._height + 10;if (answers.findValue(ans) != -1 || answers[0] == '*'){  te.border = false;  te.type = "dynamic";  Key.removeListener(te);  dlg.nextPage();} else {  fb = "Try again.";  if (attempts == myInfo.attempts){    //attempts reached. show a hint    fb = myInfo.dialogStep[dlg.getPageIndex()].hint;  }  if (attempts >= Number(myInfo.attempts) + 1){    //still no dice. Show the right answer    te.text = answers[0];    fb = "The correct answer is shown.";    if (dlg.getPageIndex() < dlg.pages.length - 1){      fb += " Press enter to move on.";    }    te.type = "dynamic";  }  Selection.setFocus(te);}]]></SCR>						<DIS embedVars="1" id="feedback" name="fb" x="te._x" y="te._y + te._height + 20" w="te._width" h="10" type="text"><![CDATA[{fb}]]></DIS>					</RES>				</INT>				<SCR name="setup"><![CDATA[te.background = true;te.backgroundColor = 0xFFFFCC;te._height = 100;Selection.setFocus(te);attempts = 0;]]></SCR>			</PG>		</DEC>		<INT name="restart" perpetual="0">			<RES swf="templatePath + 'common/button.swf'" name="restart" type="button" x="560" y="initY + qt._height - 18" label="Restart" erase="1" exit="0">				<SCR name="restart"><![CDATA[rootIcon.gotoPage(rootIcon.getPageIndex() - 1);]]></SCR>			</RES>		</INT>	</PG>