	<PG name="quiz">		<SCR isFunc="1" name="sortOptionTxt"><![CDATA[// _______________ FUNCTION ___________________// SETS OPTION TEXT TO INCLUDE VALUES FOR ANY VARIABLES// variable names in option text should be marked up with { }ansTxt = textToCheck;tempTxt = '';tempNo = 0;// replaces variable names in answer with valuefor (k=0;k<variables.length;k++){  varNo = 0;  counter = 0;  while (varNo < ansTxt.length){    // searches ansTxt for each variable    varPos = ansTxt.indexOf(markUpStart+variables[k]+markUpEnd,varNo);    if (varPos == -1) // none or no more found    {      tempTxt += ansTxt.substring(tempNo,ansTxt.length);      varNo = ansTxt.length;      // will leave while loop now    } else { // variable found      varName = variables[k];      varValue = expression(varName, this);      tempTxt += ansTxt.substring(tempNo,varPos) + varValue;      varNo = varPos+variables[k].length;      tempNo = varNo+2;    }  }    ansTxt = tempTxt;  tempTxt = "";  tempNo = 0;}textToCheck = ansTxt;//debug("fnct "+textToCheck);]]></SCR>		<SCR name="getPageID"><![CDATA[// SET UP PAGE & GET INFO NEEDED FROM XML// recalculate variable valuesvaluesCalc = 0;getAlgebraInfo();pageIcon = icon.parentNode.clip();myXML = new XML(extXML.firstChild.childNodes[rootIcon.getPageIndex() - pgOffset]);pageIcon.templateData = myXML.toObject();rootIcon.setTitleText(templateData.learningObject[0].name);myInfo = pageIcon.templateData.quiz[0];//make questionsif (icon.attributes.built != 'true'){  icon.parentNode.getChildByName("questions").firstChild.duplicate(myInfo.question.length - 1);  icon.attributes.built = 'true';}quizPageTracking = new Array();quizScoreTracking = new Array();align = myInfo.align;//sequencingif (myInfo.order == 'random'){  icon.parentNode.getChildByName("questions").attributes.branch = 'randomUnused';} else {  icon.parentNode.getChildByName("questions").attributes.branch = 'sequence';}panelWidth = myInfo.panelWidth;if (panelWidth == "Small"){  panelW = 300;  textW = 440;} else if (panelWidth == "Medium"){  panelW = 450;  textW = 290;} else if (panelWidth == "Large"){  panelW = 600;  textW = 150;} else {  panelW = 760;  textW = 0;}if (myInfo.narration != undefined){  narration = myInfo.narration;  rootIcon.broadcast('showAudio');}questionNo = myInfo.question.length; // no. questionsoptionArray = new Array();           // text for optionsquestionOptionNo = new Array();      // index of 1st option in optionArray for each questiontemp = 0;for (i=0;i<questionNo;i++){  optionNo = myInfo.question[i].option.length;  if (i==0) {    questionOptionNo.push(0);  } else {    questionOptionNo.push(questionOptionNo[i-1]+myInfo.question[i-1].option.length);  }  for (j=0;j<optionNo;j++)  {    optionArray.push(myInfo.question[i].option[j].text);    textToCheck = optionArray[temp];    sortOptionTxt(); // calls function to replace any vars in answer with values     optionArray.splice(temp,1,textToCheck);    temp++;  }}]]></SCR>		<DIS tabIndex="-1" id="panel" h="474" w="panelW" name="panel" x="align == 'left' ? 20 : 780 - panelW" y="20" type="ext" url="templatePath + 'common/whitePanel.swf'"><![CDATA[]]></DIS>		<INT name="loadPanel" perpetual="0">			<RES name="onLoad" type="event" eventName="onLoad" icon="panel" erase="1" exit="1">				<SCR name="calculate"><![CDATA[//ok to move on]]></SCR>			</RES>		</INT>		<DIS id="instructions" embedVars="1" name="intructions" x="align == 'left' ? panel._x + panel._width + 20 : 20" y="20" w="textW" h="10" type="text"><![CDATA[{myInfo.instructions}]]></DIS>		<DEC id="quiz" name="questions" repeat="all" branch="blaH" pause="0" erase="1" eraseOnExit="0">			<PG name="protoQuestion">				<SCR name="setup"><![CDATA[if (myInfo.question[quiz.getPageIndex()].image != undefined){  prptWidth = (panelW / 2) - 30;} else {  icon.parentNode.getChildByName("loader").removeNode();  prptWidth = panelW - 40;}]]></SCR>				<DIS embedVars="1" textColour="#000000" id="prpt" name="Prompt" x="panel._x + 20" y="panel._y + 20" w="prptWidth" h="10" type="text"><![CDATA[{'<b>Question ' + quiz.repCount + ' of ' + quiz.pages.length + '</b><br>' + myInfo.question[quiz.getPageIndex()].prompt}]]></DIS>				<DIS tabIndex="-1" id="image" name="image" x="prpt._x + prpt._width + 20" y="prpt._y" type="ext" url="{myInfo.question[quiz.getPageIndex()].image}"><![CDATA[]]></DIS>				<INT name="loader" perpetual="0">					<RES name="onLoad" type="event" eventName="onLoad" icon="image" erase="1" exit="1">						<SCR name="resize"><![CDATA[image.constrain(prptWidth, panel._height - 40);p = image._width / image._height;image._x = panel._x + panel._width - 20 - image._width;]]></SCR>					</RES>				</INT>				<SCR name="makeOptions"><![CDATA[optionTracking = new Array();ln = myInfo.question[quiz.getPageIndex()].option.length;if (ln > 2 && icon.attributes.built != 'true'){  icon.nextSibling.childNodes[1].duplicate(ln - 2);  icon.attributes.built = 'true';}//multi answer?if (myInfo.question[quiz.getPageIndex()].type == 'Multiple Answer'){  for (i = 0; i < ln; i++){    icon.nextSibling.childNodes[i].attributes.type="checkBox";  }}for (i = 0; i < ln; i++){  optionTracking.push(0);  // gives them all unique names  icon.nextSibling.childNodes[i].attributes.rs = 'option'+i;  if (myInfo.question[quiz.getPageIndex()].option[i].correct == 'true'){    icon.nextSibling.childNodes[i].attributes.correct = 1;  } else {    icon.nextSibling.childNodes[i].attributes.correct = 0;  }}]]></SCR>				<INT id="ques" name="protoInteraction" perpetual="0">					<RES w="prptWidth" textColour="#000000" name="protoOption" type="radio" x="prpt._x" y="prpt._y + prpt._height + 20" label="{optionArray[questionOptionNo[quiz.getPageIndex()]+icon.index()]}" group="grp" erase="1" exit="0">						<SCR name="judge"><![CDATA[//track the questionif (myInfo.question[quiz.repCount - 1].type == 'Single Answer'){  for (i = 0; i < ln; i++){    optionTracking.splice(i,1,0);  }  optionTracking.splice(icon.parentNode.index(),1,1);} if (myInfo.question[quiz.repCount - 1].type == 'Multiple Answer'){  if (icon.parentNode.clip().getValue() == true){    optionTracking.splice(icon.parentNode.index(),1,1);  } else {    optionTracking.splice(icon.parentNode.index(),1,0);  }} btnSubmit.setEnabled(true);]]></SCR>					</RES>					<RES w="prptWidth" textColour="#000000" name="protoOption" type="radio" x="prpt._x" y="_ytile + 10" label="{optionArray[questionOptionNo[quiz.getPageIndex()]+icon.index()]}" group="grp" erase="1" exit="0">						<SCR name="judge"><![CDATA[//track the questionif (myInfo.question[quiz.getPageIndex()].type == 'Single Answer'){  for (i = 0; i < ln; i++){    optionTracking.splice(i,1,0);  }  optionTracking.splice(icon.parentNode.index(),1,1);} if (myInfo.question[quiz.getPageIndex()].type == 'Multiple Answer'){  if (icon.parentNode.clip().getValue() == true){    optionTracking.splice(icon.parentNode.index(),1,1);  } else {    optionTracking.splice(icon.parentNode.index(),1,0);  }} btnSubmit.setEnabled(true);]]></SCR>					</RES>					<RES toolTip="Submit" swf="templatePath + 'common/button.swf'" enabled="false" rs="btnSubmit" name="submit" type="button" x="icon.previousSibling.clip()._x" y="_ytile + 10" label="Submit" erase="1" exit="0">						<SCR name="makeFeedback"><![CDATA[//single answer feedbackfb = "";for (i=0; i<ln; i++){  if (optionTracking[i] == 1){    fb += myInfo.question[quiz.getPageIndex()].option[i].feedback + '\r\r';  }}fb = '<b>Feedback</b><br>' + fb;if (myInfo.judge == 'true'){  if (myInfo.question[quiz.getPageIndex()].type == 'Single Answer'){    if (ques.judge()){      fb+='Your answer is correct';    } else {      fb += 'Your answer is incorrect.';    }  } else {    if (ques.judge()){      fb+='You have selected all the correct answers';    } else {      fb += 'You have not selected all the correct answers';    }  }}//track the scorm score?if (ques.judge()){  quizScoreTracking[quiz.getPageIndex()] = 1;} else {  quizScoreTracking[quiz.getPageIndex()] = 0;}]]></SCR>						<DIS embedVars="1" scrolling="auto" textColour="#000000" name="feedback" x="btnSubmit._x" y="btnSubmit._y + btnSubmit._height + 20" w="prptWidth" h="474 - (btnSubmit._y + btnSubmit._height) - 40" type="text"><![CDATA[{fb}]]></DIS>						<SCR name="enableNext"><![CDATA[btnNext.setEnabled(true);]]></SCR>					</RES>					<RES toolTip="Next Question" enabled="false" rs="btnNext" swf="templatePath + 'common/button.swf'" name="next" type="button" x="icon.previousSibling.clip()._x" y="455" label="Next" erase="1" exit="1">						<SCR name="next"><![CDATA[//move on]]></SCR>					</RES>				</INT>			</PG>		</DEC>		<SCR name="scorm"><![CDATA[score = Math.ceil(quizScoreTracking.sum() / quizScoreTracking.length * 100);if (myInfo.scorm == 'Track Last Score'){  _level0.setValue('cmi.core.score.raw', score);}if (myInfo.scorm == 'Track First Score'){  if (isNaN(_level0.getValue('cmi.core.score.raw'))){    _level0.setValue('cmi.core.score.raw', score);  }}fb = 'The quiz is complete. ' + myInfo.feedback;if (myInfo.judge == 'true'){  fb += '<br><br>You scored ' +  quizScoreTracking.sum() + ' / ' + quizScoreTracking.length + '.';}]]></SCR>		<DIS embedVars="1" id="finalScore" name="finalScore" x="panel._x + 20" y="panel._y + 20" w="400" h="10" type="text"><![CDATA[{fb}]]></DIS>		<INT name="restart" perpetual="0">			<RES swf="templatePath + 'common/button.swf'" name="restart" type="button" x="finalScore._x" y="finalScore._y + finalScore._height + 20" label="Restart" erase="1" exit="0">				<SCR name="restart"><![CDATA[rootIcon.gotoPage(rootIcon.getPageIndex() - 1);]]></SCR>			</RES>		</INT>	</PG>