	<LO styleSheet="templatePath + 'common/styles.css'" stageSize="980,720" stageColour="0xFFCC66" templateData="FileLocation + 'vpt.xml'" name="Learning Object">		<SCR name="setup"><![CDATA[//how many sections are there?sectionCount = templateData.vpt[0].section.length;//so duplicate the prototypical page that many times -1 (cos we already have the first one)icon.nextSibling.getChildByName('protoSection').duplicate(sectionCount - 1);]]></SCR>		<IFC name="Interface" title="My Learning Object" visuals="0">			<FW_ENT name="controls">				<SCR name="drawStage"><![CDATA[rootIcon.beginFill(templateData.vpt[0].backgroundColour,100);rootIcon.drawRect(0,0,980,720);]]></SCR>				<DEC name="interface" repeat="all" branch="sequence" pause="0" erase="0" eraseOnExit="0">					<PG name="functions">						<SCR isFunc="1" name="moveTabs"><![CDATA[for (i = 0 ; i <= sectionCount; i++){  tempIC = engine['tab' + i];  tempIC.clear();  tempIC.clearFilters();  tempIC.beginFill(templateData.vpt[0].section[i].tabColour != undefined ? templateData.vpt[0].section[i].tabColour : 0xFFFFFF, 100);  tempIC.lineStyle(0,0x000000,100);  if (i <= args[0]){    tempIC._x = 20;    tempIC.moveTo(20,-4);    tempIC.lineTo(0,2);    tempIC.lineTo(0,32);    tempIC.lineTo(20,39);    tempIC.lineTo(20,-4);    tempIC.swapDepths(i);  } else {    tempIC._x = 940;    tempIC.moveTo(0,-4);    tempIC.lineTo(20,2);    tempIC.lineTo(20,32);    tempIC.lineTo(0,39);    tempIC.lineTo(0,-4);    tempIC.swapDepths( -i );  }}]]></SCR>						<SCR isFunc="1" name="showControls"><![CDATA[btnPrev._visible = args[0];btnMenu._visible = args[0];btnNext._visible = args[0];]]></SCR>					</PG>					<PG name="backgroundInterface">						<DIS name="background" x="0" y="0" type="ext" url="templatePath + 'common/bg.jpg'"><![CDATA[]]></DIS>					</PG>					<PG name="navigationControllers">						<SCR name="makeNavigation"><![CDATA[//make the right number of tabsicon.nextSibling.duplicate(sectionCount - 1);//create the right number of event handlersintIC = icon.parentNode.getChildByName('sectionNavigator');intIC.firstChild.duplicate(sectionCount - 1);controlInteraction = icon.parentNode.getChildByName('sectionNavigator');//give them an idfor (i = 0; i <= sectionCount; i++){  icon.parentNode.childNodes[i + 1].attributes.id = 'tab' + i;  icon.parentNode.childNodes[i + 1].attributes.textColour = '#' + templateData.vpt[0].section[i].textColour.substr(2);  intIC.childNodes[i].attributes.icon = 'tab' + i;}]]></SCR>						<DIS toolTip="Hello" textSize="18" name="protoTabButton" x="940" y="40*icon.index()" w="20" h="10" type="text"><![CDATA[{'<b>' + templateData.vpt[0].section[icon.index() - 1].label + '</b>'}]]></DIS>						<DIS id="resTab" toolTip="Hello" textSize="18" name="ResTabButton" x="940" y="40*icon.index()" w="20" h="10" type="text"><![CDATA[<b>R</b>]]></DIS>						<INT name="sectionNavigator" perpetual="1">							<RES name="protoEventHandler" type="event" eventName="onRelease" icon="tab1" erase="1" exit="0">								<SCR name="navigate"><![CDATA[btnPrev._visible = true;btnNext._visible = true;moveTabs(icon.parentNode.index());rootIcon.gotoPage(icon.parentNode.index() + 1);]]></SCR>							</RES>							<RES name="resTabHandler" type="event" eventName="onRelease" icon="resTab" erase="1" exit="0">								<SCR name="navigate"><![CDATA[moveTabs(icon.parentNode.index());showControls(true);rootIcon.gotoPage(icon.parentNode.index() + 1);]]></SCR>							</RES>							<RES visible="0" rs="btnPrev" toolTip="Previous Page" swf="templatePath + 'common/back.swf'" name="prevPage" type="button" x="850" y="670" label="Back" erase="1" exit="0">								<SCR name="goBack"><![CDATA[fw.prevPage();]]></SCR>							</RES>							<RES visible="0" rs="btnMenu" toolTip="Menu" swf="templatePath + 'common/menu.swf'" name="toMenu" type="button" x="875" y="670" label="Menu" erase="1" exit="0">								<SCR name="goBack"><![CDATA[rootIcon.gotoPage(0);showControls(false);moveTabs(-1);]]></SCR>							</RES>							<RES visible="0" rs="btnNext" toolTip="Next Page" swf="templatePath + 'common/next.swf'" name="nextPage" type="button" x="900" y="670" label="Next" erase="1" exit="0">								<SCR name="goNext"><![CDATA[fw.nextPage();]]></SCR>							</RES>						</INT>						<SCR name="drawLabels"><![CDATA[for (i = 0; i < sectionCount; i++){  tempIC = engine['tab' + i];  tempIC.txt._y += 4;}moveTabs(-1);resTab.beginFill(0xFFFFFF, 100);resTab.lineStyle(0,0x000000,100);resTab.moveTo(0,-20);resTab.lineTo(20,-10);resTab.lineTo(20,30);resTab.lineTo(0,40);resTab.lineTo(0,-20);]]></SCR>					</PG>				</DEC>			</FW_ENT>			<PG name="intro">				<SCR name="makeTOC"><![CDATA[if (icon.attributes.built != 'true'){  protoTOC = icon.parentNode.getChildByName('protoTOC');  protoTOC.duplicate(templateData.vpt[0].section.length - 1);  intIC = icon.parentNode.getChildByName('navigation');  protoEvent = intIC.firstChild.duplicate(templateData.vpt[0].section.length - 1);  for (i = 0; i < templateData.vpt[0].section.length; i++){    icon.parentNode.childNodes[i + 2].attributes.id = 'toc' + i;    icon.parentNode.childNodes[i + 2].attributes.textColour = '#' + templateData.vpt[0].section[i].textColour.substr(2);    intIC.childNodes[i].attributes.icon = 'toc' + i;  }}icon.attributes.built = 'true';//make intro resourceslinks = templateData.vpt[0].links.split('||');linkStr = '<font color="#000099">';for (i = 0; i < links.length; i++){  linkRow = links[i].split("|");  linkStr += '<a href="' + linkRow[1] + '" target="_blank">' + linkRow[0] + '</a><br>';}linkStr += '</font>';]]></SCR>				<DIS id="intro" name="intro" x="60" y="40" w="400" h="10" type="text"><![CDATA[{'<font size="24">' + templateData.vpt[0].name + '</font><br>' + templateData.vpt[0].desc + '<br><br><br>' + templateData.vpt[0].supportInfo + '<br><br><b>Resources</b><br>' + linkStr}]]></DIS>				<DIS name="protoTOC" x="560" y="40 + 40 * (icon.index() - 2)" w="370" h="10" type="text"><![CDATA[{'<font size = "12"><b>' + templateData.vpt[0].section[icon.index() - 2].name + '</b></font><br>' + templateData.vpt[0].section[icon.index() - 2].desc}]]></DIS>				<DIS id="resNav" name="resources" x="560" y="40 + 40 * (icon.index() - 2)" w="370" h="10" type="text"><![CDATA[<font size = "12"><b>Resources</b></font>A list of useful resources]]></DIS>				<INT name="navigation" perpetual="1">					<RES name="protoTOCNav" type="event" eventName="onRelease" icon="id" erase="1" exit="0">						<SCR name="navigate"><![CDATA[moveTabs(icon.parentNode.index());showControls(true);rootIcon.gotoPage(icon.parentNode.index() + 1);]]></SCR>					</RES>					<RES name="resNav" type="event" eventName="onRelease" icon="resNav" erase="1" exit="0">						<SCR name="gotoResources"><![CDATA[moveTabs(icon.parentNode.index());showControls(true);rootIcon.gotoPage(icon.parentNode.index() + 1);]]></SCR>					</RES>				</INT>				<SCR name="drawTOC"><![CDATA[for (i = 0; i < templateData.vpt[0].section.length; i++){  engine["toc" + i].lineStyle(0, 0x000000, 100);  engine["toc" + i].beginFill(templateData.vpt[0].section[i].tabColour, 100);  engine["toc" + i].drawRect(-5,0,370,35);}//draw resources tabresNav.lineStyle(0,0x000000,100);resNav.beginFill(0xFFFFFF,100);resNav.drawRect(-5,0,370,35);]]></SCR>			</PG>			<PG name="protoSection" title="Page Title" help="Page Help">				<SCR name="getData&duplicatepages"><![CDATA[secNum = rootIcon.getPageIndex() - 2;//create the pages for this sectionif (icon.attributes.built != 'true'){  icon.nextSibling.childNodes[1].duplicate(templateData.vpt[0].section[secNum].page.length - 1);  icon.attributes.built = 'true';}]]></SCR>				<FW id="fw" name="sectionPages">					<FW_ENT name="sectionControls">						<SCR name="buildLinks"><![CDATA[links = templateData.vpt[0].section[secNum].links.split('||');linkStr = '<font color="#000099">';for (i = 0; i < links.length; i++){  linkRow = links[i].split("|");  linkStr += '<a href="' + linkRow[1] + '" target="_blank">' + linkRow[0] + '</a><br>';}linkStr += '</font>';]]></SCR>						<DIS name="sectionTitle" x="60" y="40" w="400" h="10" type="text"><![CDATA[{'<font size="24">' + templateData.vpt[0].section[secNum].name + '</font><br><br>' + templateData.vpt[0].section[secNum].text + '<br><br><b>Resources</b><br>' + linkStr}]]></DIS>						<DIS id="orient" name="secOrientation" x="670" y="673" w="100" h="10" type="text"><![CDATA[{'<b>Page ' + (fw.currentPage + 1) + ' of ' + fw.pageCount + '</b>'}]]></DIS>						<INT name="orientation" perpetual="0">							<RES name="onOpenPage" type="event" eventName="onOpenPage" icon="fw" erase="1" exit="0">								<SCR name="orient"><![CDATA[orient.setText('<b>Page ' + (fw.currentPage + 1) + ' of ' + fw.pageCount + '</b>');]]></SCR>							</RES>							<RES name="onClosePage" type="event" eventName="onClosePage" icon="fw" erase="1" exit="0">								<SCR name="getDrawing"><![CDATA[drawingData[secNum][pageNum] = myDraw.getData();so.data.drawingData = drawingData;so.flush();]]></SCR>							</RES>						</INT>					</FW_ENT>					<PG name="protoPage">						<SCR name="setup"><![CDATA[pageNum = fw.getPageIndex() - 1;]]></SCR>						<DIS id="image" name="image" x="1200" y="60" type="ext" url="{templateData.vpt[0].section[secNum].page[pageNum].url}"><![CDATA[]]></DIS>						<INT name="onLoad" perpetual="0">							<RES name="onLoad" type="event" eventName="onLoad" icon="image" erase="1" exit="0">								<INT id="loadFlashPaper" name="loadFlashPaper" perpetual="0">									<RES name="onEnterFrame" type="event" eventName="onEnterFrame" icon="image" erase="1" exit="0">										<SCR name="load"><![CDATA[if (image.getLoadedMovie().getIFlashPaper() != undefined){  image._x = 540;  image.getLoadedMovie().getIFlashPaper().setSize(380,600);  loadFlashPaper.exit();};]]></SCR>									</RES>								</INT>							</RES>							<RES rs="btnMin" visible="0" swf="templatePath + 'common/zoomOut.swf'" toolTip="Return to Portfolio" name="min" type="button" x="100" y="5" label="label" erase="1" exit="0">								<SCR name="min"><![CDATA[image._x = 540;image._y = 60;btnMin._visible = false;btnMax._visible = true;image.getLoadedMovie().getIFlashPaper().setSize(380,600);]]></SCR>							</RES>							<RES rs="btnMax" toolTip="Enlarge" swf="templatePath + 'common/zoomIn.swf'" name="max" type="button" x="540" y="670" label="label" erase="1" exit="0">								<SCR name="max"><![CDATA[btnMin._visible = true;btnMax._visible = false;image._x = 0;image._y = 0;image.getLoadedMovie().getIFlashPaper().setSize(980,720);]]></SCR>							</RES>						</INT>					</PG>				</FW>			</PG>			<PG name="references" title="Page Title" help="Page Help">				<SCR name="getFirstHalf"><![CDATA[btnPrev._visible = false;btnNext._visible = false;//find the mid pointmidPoint = Math.ceil(templateData.vpt[0].section.length / 2);//make intro resourceslinks = templateData.vpt[0].links.split('||');linkStr = '<b>General</b><br><font color="#000099">';for (i = 0; i < links.length; i++){  linkRow = links[i].split("|");  linkStr += '<a href="' + linkRow[1] + '" target="_blank">' + linkRow[0] + '</a><br>';}linkStr += '</font>';for (i = 0; i < midPoint; i++){      links = templateData.vpt[0].section[i].links.split('||');    linkStr += "<br><b>" + templateData.vpt[0].section[i].name + '</b><br>';  linkStr += '<font color="#000099">';  for (j = 0; j < links.length; j++){    linkRow = links[j].split("|");    linkStr += '<a href="' + linkRow[1] + '" target="_blank">' + linkRow[0] + '</a><br>';  }  linkStr += '</font>';}]]></SCR>				<DIS name="links1" x="60" y="60" w="400" h="10" type="text"><![CDATA[{linkStr}]]></DIS>				<SCR name="getSecondHalf"><![CDATA[//get all resourceslinkStr = "";for (i = midPoint; i < templateData.vpt[0].section.length; i++){      links = templateData.vpt[0].section[i].links.split('||');    linkStr += "<br><b>" + templateData.vpt[0].section[i].name + '</b><br>';  linkStr += '<font color="#000099">';  for (j = 0; j < links.length; j++){    if (links[j].indexOf('|') != -1){      linkRow = links[j].split("|");      linkStr += '<a href="' + linkRow[1] + '" target="_blank">' + linkRow[0] + '</a><br>';    } else {      linkStr += 'No resources for this section';    }  }  linkStr += '</font>';}]]></SCR>				<DIS name="links2" x="540" y="20" w="400" h="10" type="text"><![CDATA[{linkStr}]]></DIS>			</PG>		</IFC>		<BIN name="Deleted Items" />	</LO>